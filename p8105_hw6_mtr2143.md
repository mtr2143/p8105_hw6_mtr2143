Homework 6
================
Matthew T. Russell

# Problem 1

``` r
birthweight_data <- read_csv("https://www.p8105.com/data/birthweight.csv")

birthweight_missing <- map_df(birthweight_data, ~sum(is.na(.))) %>% 
  pivot_longer(
    cols = babysex:wtgain,
    names_to = "variable", 
    values_to = "num_missing"
  )

birthweight_missing %>% kable()
```

| variable | num_missing |
|:---------|------------:|
| babysex  |           0 |
| bhead    |           0 |
| blength  |           0 |
| bwt      |           0 |
| delwt    |           0 |
| fincome  |           0 |
| frace    |           0 |
| gaweeks  |           0 |
| malform  |           0 |
| menarche |           0 |
| mheight  |           0 |
| momage   |           0 |
| mrace    |           0 |
| parity   |           0 |
| pnumlbw  |           0 |
| pnumsga  |           0 |
| ppbmi    |           0 |
| ppwt     |           0 |
| smoken   |           0 |
| wtgain   |           0 |

From the table above, we can see that none of the variables contain any
NA values.

``` r
birthweight_data %>% 
  group_by(frace) %>% 
  summarize(
    total = n()
  ) %>% 
  kable()
```

| frace | total |
|------:|------:|
|     1 |  2123 |
|     2 |  1911 |
|     3 |    46 |
|     4 |   248 |
|     8 |    14 |

Per the data description, we know that the variable correspond to the
father’s race has a value for observations where the value is unknown
(`frace == 9`), However, from the table above, we can see that there
aren’t any observations that have this value.

Now that we know there aren’t any missing values, we can fit a model.

``` r
birthweight_df <-
  birthweight_data %>% 
  mutate(
    babysex = ifelse(babysex == 1, "male", "female") %>% 
      forcats::as_factor() %>% 
      relevel(ref = "male"),
    frace = case_when(
      frace == 1 ~ "white", 
      frace == 2 ~ "black", 
      frace == 3 ~ "asian", 
      frace == 4 ~ "puerto rican", 
      frace == 8 ~ "other"
    ) %>% 
      forcats::as_factor() %>% 
      relevel(ref = "other"),
    malform = ifelse(malform == 0, "absent", "present") %>% 
      forcats::as_factor() %>% 
      relevel(ref = "absent"), 
    mrace = case_when(
      mrace == 1 ~ "white", 
      mrace == 2 ~ "black", 
      mrace == 3 ~ "asian", 
      mrace == 4 ~ "puerto rican"
    ) %>% 
      forcats::as_factor() %>% 
      relevel(ref = "puerto rican")
  )
```

``` r
bwt_fit <- lm(bwt ~ fincome + frace + gaweeks + mrace + momage + smoken, data = birthweight_df)

bwt_fit %>% 
  broom::tidy() %>% 
  select(term, estimate, p.value) %>% 
  mutate(
    term = str_replace(term, "^frace", "frace: "), 
    term = str_replace(term, "^mrace", "mrace: ")
  ) %>% 
  knitr::kable(digits = 3)
```

| term                | estimate | p.value |
|:--------------------|---------:|--------:|
| (Intercept)         |  762.535 |   0.000 |
| fincome             |    0.412 |   0.158 |
| frace: white        |    1.005 |   0.993 |
| frace: black        |  -40.796 |   0.759 |
| frace: asian        |  -12.476 |   0.938 |
| frace: puerto rican |  -49.264 |   0.721 |
| gaweeks             |   59.453 |   0.000 |
| mrace: white        |  135.953 |   0.064 |
| mrace: black        |  -96.733 |   0.274 |
| mrace: asian        |  -30.655 |   0.817 |
| momage              |    1.517 |   0.431 |
| smoken              |  -10.878 |   0.000 |

I chose to run a model where baby’s birthweight (g) is predicted by
family income, father’s race, gestational age at delivery (weeks),
mother’s race, mother’s age at delivery (years), and average number of
cigarettes smoked per day during pregnancy. The goal of this model was
to predict birthweight based on known biological factors that influence
birthweight (gestational age and number of cigarettes smoked during
pregnancy) with social factor (family income and father and mother’s
race).
